[build]
  # Base directory for the build (relative to repository root)
  # Your Angular app is in NotesApi/notes-web
  base = "NotesApi/notes-web"
  
  # Build command - build Angular app as static site (browser only, no SSR)
  # The --output-hashing=all ensures proper cache busting
  command = "npm install && npm run build -- --output-hashing=all"
  
  # Directory to publish (output directory after build)
  # Angular outputs to dist/notes-web/browser
  publish = "dist/notes-web/browser"

# Note: Angular plugin is auto-detected by Netlify
# Since we're building a static site (outputMode: "static" in angular.json),
# the plugin should work correctly. If it causes issues, disable it in Netlify Dashboard:
# Site settings → Build & deploy → Build plugins → Remove @netlify/angular-runtime

# Temporary: Proxy API requests to HTTP backend until SSL is active
# Once SSL is active on backend, remove this and use direct HTTPS
[[redirects]]
  from = "/api/*"
  to = "http://mynotesapp.runasp.net/api/:splat"
  status = 200
  force = true

# Redirect all routes to index.html for Angular routing (SPA)
# This ensures Angular routes work on refresh
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

# Optional: Set Node version (Netlify will auto-detect, but you can specify)
# [build.environment]
#   NODE_VERSION = "20"
